messages = [[402918176814088433362804012427723518038188419481, 89993717179075830946036628321814642673793613134, 91555656182657371838118014598805280513990537879138459819685838612132761340215213967563773375327326090530643426099187226638997223814212018432154847586776873635796518805336404122498469774932569331739132376816451074599939376675024691538317801042202326734147442605231542518272351719185025641426073707653457842432, 47122737841603670315946500348394014045705647377623040196617782602664795536058771048656255059195519945963574138175327265291498085927450257766370837706220700012501344511504306432721024535455056550665316594427591603927225514802506296310816954594437283419141259343650186698354682760902187346654308285809620606812], [468285987570268934184319122548408909795038660963, 18346170221899920039351272459445964098337670753, 2314646713629918499856779629177449087139822395089846167502729000878350175043356344362735712320758784590985255196534457360225912022206685137565798467119332621257357328768411712172089129584217482753339276771276921415811766773761201747982679773570805004610925688048139629237753552965447367313935883745279971658, 113606387993793374491914858965492150729873670607641712028694323526167635703956944180315924652396626910219828376481312469922699941064095408767963760075029031528670737683427460482967374750247667954531768189144806491970407051458915047342027643942699040232197047543911887524897188915059840894205706941312160144576], [789834900174044354025820200230080832328753542200, 59584130956949427787587681765792392331920576588, 5725894944660714431862718612211130445513003316092249131023518034078625065893839788148096176774644272550130589018440352581402460232361483715703340686542311105655701467100228955984820695341702859300601589764311299037119770785652372707967397362795988730998926902593584642025941222808945790671551397333852790984, 19171193855214076683121480873174377778912960377219296504784842930205553141360927095681194629705317217648602352602882457291084610421083488329399746092985421219818035109153811998478462828188929362613063316632574129252139717501022697643437585226221338212569334434883785559103756343333491210077368966441426638154], [522256626425659128769353992281417635361788709539, 13958470106740399948276861293387825992401977308, 98714565779986447765062153834617335901822066478577001548661675875252608257214414491713814701069889695652104734125934326796654331524837833875853704609535450805986035525054846880635769389448902832866885264066661907689805278775350725640478290242672882286276536420194897936869358600938414719405534946085050150920, 69516242677739119999490472973054878602814146857369303846155871564431194906166388502290716012961222840924087757604226611607467428222417530656398241155142560509464860004446710168606811414414408038634976574304961350744268069114276382288106819635673662989665508803548906598422373131980920046125595378940000100704], [1315228103700203662153879667074261853564120277183, 72315400826998109753625825448222132543004036908, 73798034189510599660460422843348921409747313944297347503683691315872547649756296001706375237526036675233548373182350717095931941685191551494135197545756292264664936176233131519657197850286751566420684350136393863545007711413405755816908594304442173958801361966067452630942278050466037853706605680343378344833, 84085989829119306581111031144818403466555903283607644200262567162388005141483321587588758784742371896268683641031479165158504667347550422597558791834277515768740019416819521081326962092943799358958010384072890658130153172376726586618046366055816038008220999993420576299253909508026657284000145088984816675169], [1059190161647142188515838807420456015831951033261, 62994570041845816902708119666148775793695107578, 31098806714547700634243005528000742882198197123419348092946908455178586261899563909930393982591104807138884486250506404141597448342897885601777506109376460629344396656279855649788057988876400989108346701187741578341554905097744543036979715427106994930258742629859067449806494917951421401915024811860082481417, 20291613998687982883487843105702373385895836173848775769526524569401338153354971614114552384580692445871208285712137059157728228171214317246489075608879466566402583264626663355026030153584564917112760089745382884277448063300473070746147239477087983824321162959484794726060593906231544057594564076739722324593], [497021029317473415268045259412129513492106120311, 58015172456651271974934432923682394600377115189, 62699364180780346255257023013604711460743401457264161595923488821976627333858832390203700189533914890068643780938523632629328378242114641498439430721818047178933674515460586836624464263420738753620960965259424711166484763034981252522912692355477914573016827206194656037165081798509885507445302491736790387671, 115311289953660593930346674892482052930132637714183231380421404358862707671961803150710581329880229102832045119714010618640045207036554685780954554397288539237448230792447397236094111024043020820271868619149834826847007719443760254353013132861720267635587437971951837695047251870367408964494792170032039420498], [316469283084901254040083556507596772057798861424, 23302561310485372321953937746263078113548616234, 94940510670077895567656889067925495952385712221965815401640117028975634378679500383875523566184501674532233984382112231152976810578792861469780417525832511535619094092064789156743109315448631460364850144370637511096672092711114624588109120000140381855046934928717443437424208212466310098329668033537753102634, 31145377195011883703974512144972149007590359354958294923975381414595338475482253982199432559125182078311847951122682682454148153342969282421835619567604031138405452866414279609394176462321303826087803820744639743595264011653924220417720578841717558839799942556335926403504101757318392935035132813515029635272], [106144757300956321235441657612406507709853311187, 1795766213602757342191190237589583428910751552, 61528240150826616738201044879085472807759629794385387780519746241848691094093539493131195807035092321114605633958741004768062116843490986653454213833503142153348306165505246435327058239297345995172910080579217120815766786277836143701890081721412298211552786581353290335351784889526723596024808940084512219319, 106710953375208872333865815251927268075388972241109585382079403287821848540347875494594914873950221041310223131884602182128200516352224235183015915889368716676063492542078793725702738563828386961901226648022919252917162703552109480787528305061261014497832231051237467948454366307597821191978480472005185435975], [502008074457718621319932234908944711265626336372, 94710807423880542012566428955578477802234243914, 52099630574588384330026999315588922657276430262091236281212937034202433702864419277756745429634523175681145240870956257649786263330977150260973837966294032249015768232434635656209299406430589847313957680444010097686329293229548441509605744367397863224851327609471282818546697238380080050474241248219821171679, 41003325723641815612087604143356203334317367714767601181581076079847824187303702955162941996659277300500407459206759135225449260185317447997804901512742288068119196484060961725400058165892028182737312591418119503405320461035417412422504917662604597387816558765093723950715930481743225522040332463826700659793], [103301944502275831371284552132035211259847451069, 87455197993568842916872397184289519829091329908, 122030849845211741047492329384682279495511192563364901160717257827209599651248136884945611563185134590560489775390519314082759790019562448181144106490321549893988598723185344988535161005043782391753935760825725552939228656613539155693868420154895766687128877908339227987247879590492831130099047444043250957334, 110647703105888936917593959809865553270676969722962995053641457829782678154536685493578328757166430030494895737894741798375041534098291263712036719064498643837544669638575346786568573659778614001766798638286156452909354054419489470275812542033206424566071263649458519812638698513853098708713853320502040729553], [572581084767714526607860123197524951484849138919, 49877416570171201664330673552006700419687708648, 111482413191051955708640660858968753990117238431481325938317403808296041617078366525899148525732172869493872573420302649973817420190560954567717787800428625157671813277310396259692902600154048216658442656288241162169418204299435062888225576153881987414513734044399241335420851716270366699876017813665345221308, 17840955636311073344803464807653076696257331566340054662911582585838159099701136776728250283061116213667238262775270316099515211858622619955304082870038486936299561383035378622447957920957326546756350671761588102001234241274892836088248326794477194161833337379427615702463293547582891408195706111926357446031], [248496360658962230381986186546110896532059756256, 80264074814900308222992765245391463013059382583, 99556923797754847380771149873143739899659986927227624172749740853878697661211283147354915966508545139609911373304930405655019796803207785232918953008653430026480835713098909146031208424342932950479038341586351601851415196773572653653460824855386189117408815780998494630839608493959352472160691860900785335082, 48970298761947297359406670763472093004069708919192480936372814157480089721714856745069169827977858130766773748506264851084171693129027684772162065923978650299719981502043176023955221448814829010726129817715307799456207241976798269471428418101392742610562837068842071786236436373229577448830688004950753708887], [187994555130649431158204423455874144387051750788, 2656746906123081381226508828849367768479036896, 87858825003768160179950360360412356223008845419168691477876971130570712108627829470315389926193787777150994820470792211857802205378319340840649636334638687703142684802825366471771455177088073190306281916628456664457352402238299681397026839369956920872791525377491782162714828813107880737124874976463348365118, 82832664965760996152610603146228777444071484573577334082249351168273598473105751568534091495801614347438754720791582677733421892649446191837094745810693136887725664428643319079511103196513790654165589736216793550582809206296516070282325857344420205271355298077926495448102660819718186956203320684228737574667], [121293905353681939687090177421664342621588154344, 20833018564737303489190197834323340637717512603, 108352086003971573270013816321906870318557240214449229886233762517654925080371771133633163717216052385198327466020686683095906450371792789220873168199269633911199638832688991332535142790632502809716559275038342004165743264738659745510224290524108225411255266444447930791964576949355399241738605351429101839900, 16460643024638700163530401784406384133950865517498974309217758574097046242832661863148826909749695178487001207060796562298582118471828910064988690822936820819087849594769164912688304532107461713804657107902624652722658650216841163315249888990393366291035972866454985712022141917849570509207969387998987104631], [1228889923663929615007422506769121559857701755119, 40313315431078816178896622313451804823876417405, 113099471055697068756908361853979873641955293332288667041843327579605597518724004053546596553556489799991238689745706943312759808271954716040622831849723090954734892971120170332683503365834368619215860194901881231565122891008953766306718166053817954698867250769865743603912713711061174122790614111560155425078, 39349492692635862862756633397778138012457659326050202030155935849272897573924554853226311382621981796182136065607413627962257138498332949432215519917734040057695325541811877481392639886949888162061890973954809405504632725815180955859015314202046826317437697212621655680313325085913112204930664836234593880253], [523844338092390423541261782563074224511385004512, 18173938250530459643222435508277390041825598277, 42560832623738153727987076727442952716244745984892149274581747325129700132802042077785215413018295644802442055954095396582854915340462340290748146393566125917735482804613451011121730191207789279021129636226386673887984002900891297804091451043075047664868749425875317910807951117395715216174277167550867059769, 46479062924738470760170786068772789893841800890859179802683119356593855550792316501265188360731188001619626241868588641131758454979528753764090588237869065351098532804619942787861048108991355852565742673101583575303184891457990053552589094298252265220222195430868829946199840439012130247582197352076872663511], [159629023309977037451875024646249373455312455687, 103234710952485591992881935963165183410691797888, 30773623321277237670036784917598229390882854021730782706693063845898015269921904560390991128882201555406424071120520468682090225099796554337691598913441671512579855017864530040852985649652284029721232137975595668626300151194821115335345305018329933910792725643246341870599341323155109819578584060617468671084, 109336196943972849857696091531132752433481168620904993761378335271972791275546788603350912307487813220108695235852400446153794822366555349922109348477277226425277106887478297264902917449422917483816942340585794906555295470339644045799557025623904812782751367409266845808153059354651081963585632433038816297646], [1246209100440117256530132665519201852719938195691, 69638164002057954109192593367598747294790252064, 35594181124889103465153887108275592768531732226689954101966079517029239403807317005631547752275463371941512906195484981768214137329176968632774969589332108041506731237101251867480825943571042340985416891694674147424384771746887872557742633208613693151871201893682449130169129904447768551322969547441398889756, 93888674082533112418915492240577815829735603559157013598142323596615061774259529553543432484367692433840981537431753437886043116580884022517205988286466350558673457356229000258306463892282691965889580309093953741784392826386651139097962352472421685752559926862218113476662149372171660504607598417796992761532], [1092984642801256648992388582999826735742223016857, 108392414453626543687046970652762916985799917501, 112082035698932835880786015567833099664771160824550835824741749423712258229231491879613790306643458694802681505411448129058509597125051628851313267882387157483248181879577338550136105655673825817256592837147089381710567515088381985257517491458176290665419202686610300514747040115684883578970056436552331369889, 126878391455682919085998147902630936662420069237878814601256538948734093509218668644123373787774663217089931698479878717617797761885370252659137830434043425688709949359047230766884333115286621624454940492916487713101694740165229105889145843129786256779250774549353573777768770711269239575213150125759258355363], [928239810052082755256180149065753502901999626526, 100716841024615288341500128811383969686757039752, 110802475795413184475716257445709711241257097198494810470950684553800563301492786915879866927581937339671602334702120480662578230594155507897511572854583578376531456503140995265674934077197505579427061412486940146633749036489036806108321747483197241833202063006741287239175157432122098728492139821149886581769, 5463418333149617025715554239369227611859502037575254080928500993705767956694070937341978813645106538091724878440737376760155288270172816666823083948217525994082295055601616932102400047891545807406546160917746795281208919513804535499887725072504634030151518692351910860695201078653831758667506383340998363949], [132372379660207276332150370657103501303336071124, 12226545548057252255861306009517007098322763724, 64441531595362768013807735868960380111551008662877123284263905332546373360965948404836781700780575803122056969046177396616524584147879808140358041153653079781868119707066521903781573019843813448156231177715316110399640533825143771546930006813081378132710452435871054201531400351479276441034563902215663600974, 24562419541920246981656729708936112567186300807195192202812602918098460313155128732535243026530255732403106375762342436873302528185535094151933604561221863293359378534874699702980563371197062552419028991174069157622068478674462504326304544186580690250892087241456051889586754796142912395229046152381809048715], [507704914256527247174588438944837494431213414769, 112868580937053444283967460397306589268885981660, 113806332740471253304665329861340759238446233450807500262342287014161838779551543251125291945010929114177386863953565736967963745080606988897817277253637211156557800817944209747137111566301732207835430520937472368544468479771380597545617723127381284114464227414218815986724540300720321714152054076471543938666, 33577057748279120417340515724570879747942133550986636728859598193378695037520731837272107438125731903635613311952655401408302714927450111585154684696405680418298166523091567438825716651883681976756752378005859946115621610392043040986712220515359282690382813826467222491947265192915018228420493782191084007726], [7288007191988109072734928045613405361006662351, 62401376326066619114881600401304716535346267211, 45541977614064176676152116110410781710316596232356679009309842598370386424239532154033515752009661289214174777588147323707948575478790268161087753729226156025347248983233739823356593666321768679752718821714328204919208747556832090484404190833244256630771272812947228901368719304503710298736090865509047049758, 30377628743464727880377496366902110172095028059688447554744603210612270308415984358608712889451490193631502590325961852178651093499276266271717355979827463816200019060036621305429416360618152663446294253196020012330268027659279056188723782176616788788753662767662025023070947132810748592209524237125434052631], [1124474261545696560162875452922838869158141729186, 24690762568234741474719337684553197333972260128, 89767746345096238193332326231661493621257312327351728574858128927212588207497811880078824871767347620506078398551690597730790122275265158927204714707924282534574647744886812825435831977282945804069896899066129622007492163771899058919323851380518204846582390858797201864059562670454326162952297732549095858366, 116522187597384755542968510345814865615623218528196294222893259214401539133722713710689521631878742862705021012410366107348744917981615197780021210622803786552463311938111575426753804766377112780626996555917767251389116968428564897521648102875098349574113970630319771086617747295634564352164180576759040995745]]
gamma = 42043469394684464521908244311732536879608755370369083191940895207703508605737591122259392312680732201861049825589981037348863818934150778213477758748813759795189958216870896370818985914941236477786006357403412127101852814766046529482277322002725485327965141891578527574101426277555399587359311453402150513857
group_n = 135199387514598885489217854635763159360855217236898423534166060792375159443467280886088168467795837794501471428977196330106164500528346432936358701049702536556208115357728369944758219431787680181649040618521765505148960328374153044356690375528403611352905273495988865334383720787697340809831286281109475466941
q = 119368967499563816767522009892880912988405840757
alpha = 134320546455418049514693580460177576998196939986354756773696174410450314281975970033118850419954066550177334929847925188199178724895575983983569045836890042945227215038832061403883749098547874781630525372921372608719190590901435083063244471414352719764408528905373268173573985483184748146204740528178624255859



def hack_private(msgs):
            n = len(msgs)
            a = 0
            a_low = 2
            a_up = q - 1
            beta = 0
            i = 0
            T = 2^17
            iterate = 0
            while a_up - a_low > T^2:
                beta = floor((2 * log(T, 2).n(digits=20) + beta - log(q, 2).n(digits=20) / n) / (1 - 1/n))
                L = 2 ^ beta
                matrix_list = []
                for i in range(n):
                    temp_list = []
                    for j in range(n + 1):
                        temp_list.append(0)
                    temp_list[0] = msgs[i][0]
                    temp_list[i + 1] = L
                    matrix_list.append(temp_list)
                matr = matrix(matrix_list)
                lll_matr = matr.LLL()
                max_dist = 0
                max_dist_row = -1
                dist_row = 0
                shortest_vector = lll_matr[i]
                for row in lll_matr:
                    if row[0] < 0:
                        shortest_vector = row
                        shortest_vector_normalized = []
                        for i in range(n + 1):
                            if i == 0:
                                shortest_vector_normalized.append(shortest_vector[i])
                            else:
                                shortest_vector_normalized.append(shortest_vector[i] / L)
                        vec_sum = 0
                        for i in range(1, n + 1):
                            vec_sum += shortest_vector_normalized[i] * msgs[i - 1][0]
                        e_tilde = shortest_vector_normalized[0]
                        shortest_vector_normalized = shortest_vector_normalized[1:]
                        s_0_tilde = 0
                        for i in range(n):
                            s_0_tilde += shortest_vector_normalized[i] * msgs[i][1]
                        s_tilde = s_0_tilde % q
                      
                        sigma_tilde = 1
                        for i in range(n):
                            sigma_tilde *= msgs[i][2].powermod(shortest_vector_normalized[i], group_n)
                        sigma_tilde %= group_n
                        lambda_tilde = 1
                        for i in range(n):
                            lambda_tilde *= msgs[i][3].powermod(shortest_vector_normalized[i], group_n)
                            
                        lambda_tilde *= gamma.powermod((s_0_tilde - s_tilde) / q, group_n)
                        lambda_tilde %= group_n
                        x_check = (gamma.powermod(s_tilde, group_n)) * (alpha.powermod(e_tilde, group_n)) * (lambda_tilde.powermod(q, group_n))
                        sum_less = 0
                        for i in range(n):
                            if shortest_vector_normalized[i] < 0:
                                sum_less += (shortest_vector_normalized[i])
                        K_lower = sum_less * (q - 1)
                        sum_more = 0
                        for i in range(n):
                            if shortest_vector_normalized[i] > 0:
                                sum_more += shortest_vector_normalized[i]
                        K_upper = sum_more * (q - 1)
                        lower_bound_first = (K_lower - e_tilde * a_up)/q
                        lower_bound_second = (e_tilde * a)/q
                        lower_bound = floor(lower_bound_first - lower_bound_second)
                        upper_bound_first = (K_upper - e_tilde * a_low)/q
                        upper_bound_second = (e_tilde * a)/q
                        upper_bound = floor(upper_bound_first - upper_bound_second)
                        if lower_bound > upper_bound:
                            t = upper_bound
                            upper_bound = lower_bound
                            lower_bound = t
                        base = Mod(gamma, group_n)
                        lambda_mod = Mod(lambda_tilde, group_n)
                        iterate += 1
                        x = discrete_log_lambda(lambda_mod, base, bounds=(lower_bound, upper_bound))
                        floor_res = floor(-(q*x + s_tilde)/e_tilde)
                        a = floor_res % q
                        a_up = floor(K_lower / e_tilde)  + 1
                        a_low = floor(K_upper / e_tilde)
                        break
            discr_log_res = discrete_log_lambda(alpha, base, bounds=(a + a_low, a + a_up))
hack_private(messages)

base = Mod(gamma, group_n)
discr_log_res = discrete_log(alpha, base)
print(discr_log_res)